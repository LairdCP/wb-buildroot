Signed-off-by: Christian Storm <christian.storm@siemens.com>
Reported-by: Akihiro Suzuki <akihiro27.suzuki@toshiba.co.jp>
Acked-by: Stefano Babic <sbabic@denx.de>
---
 corelib/installer.c | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/corelib/installer.c b/corelib/installer.c
index edfcb6a..2dda40a 100644
--- a/corelib/installer.c
+++ b/corelib/installer.c
@@ -169,7 +169,11 @@ static int update_bootloader_env(struct swupdate_cfg *cfg, const char *script)

 		if (!key || !value)
 			continue;
+#if defined(CONFIG_UBOOT) && !defined(CONFIG_UBOOT_NEWAPI)
+		snprintf(buf, sizeof(buf), "%s %s\n", key, value);
+#else
 		snprintf(buf, sizeof(buf), "%s=%s\n", key, value);
+#endif
 		if (write(fd, buf, strlen(buf)) != (ssize_t)strlen(buf)) {
 			  TRACE("Error saving temporary bootloader environment file");
 			  close(fd);
